diff --git a/api/server.go b/api/server.go
index d84edcc1..67f5f648 100644
--- a/api/server.go
+++ b/api/server.go
@@ -7,12 +7,14 @@ import (
 	"math/rand"
 	"net"
 	"net/http"
+	"nofx/analysis"
 	"nofx/auth"
 	"nofx/config"
 	"nofx/crypto"
 	"nofx/decision"
 	"nofx/manager"
 	"nofx/market"
+	"nofx/mcp"
 	"nofx/signal"
 	"nofx/trader"
 	"os"
@@ -30,11 +32,12 @@ type Server struct {
 	traderManager *manager.TraderManager
 	database      *config.Database
 	cryptoService *crypto.CryptoService
+	mcpClient     *mcp.Client
 	port          int
 }
 
 // NewServer åˆ›å»ºAPIæœåŠ¡å™¨
-func NewServer(traderManager *manager.TraderManager, database *config.Database, cryptoService *crypto.CryptoService, port int) *Server {
+func NewServer(traderManager *manager.TraderManager, database *config.Database, cryptoService *crypto.CryptoService, mcpClient *mcp.Client, port int) *Server {
 	// è®¾ç½®ä¸ºReleaseæ¨¡å¼ï¼ˆå‡å°‘æ—¥å¿—è¾“å‡ºï¼‰
 	gin.SetMode(gin.ReleaseMode)
 
@@ -48,6 +51,7 @@ func NewServer(traderManager *manager.TraderManager, database *config.Database,
 		traderManager: traderManager,
 		database:      database,
 		cryptoService: cryptoService,
+		mcpClient:     mcpClient,
 		port:          port,
 	}
 
@@ -200,7 +204,10 @@ func (s *Server) setupRoutes() {
 		protected.GET("/equity-history", s.handleEquityHistory) // éœ€è¦è®¤è¯ï¼Œä½¿ç”¨å½“å‰ç™»å½•ç”¨æˆ·åšæƒé™æ ¡éªŒ
 		protected.GET("/performance", s.handlePerformance)
 	}
-}
+
+	// å…¬å¼€çš„åˆ†ææŠ¥å‘Š APIï¼ˆæ— éœ€è®¤è¯ï¼‰
+	api.GET("/analysis/report", s.handleGetAnalysisReport)
+	api.GET("/analysis/report/stream", s.handleGetAnalysisReportStream)
 }
 
 // handleHealth å¥åº·æ£€æŸ¥
@@ -1320,6 +1327,7 @@ func (s *Server) handleSyncBalance(c *gin.Context) {
 	err = s.traderManager.LoadUserTraders(s.database, userID)
 	if err != nil {
 		log.Printf("âš ï¸ é‡æ–°åŠ è½½ç”¨æˆ·äº¤æ˜“å‘˜åˆ°å†…å­˜å¤±è´¥: %v", err)
+		// è¿™é‡Œä¸è¿”å›é”™è¯¯ï¼Œå› ä¸ºä½™é¢å·²ç»æˆåŠŸæ›´æ–°åˆ°æ•°æ®åº“
 	}
 
 	log.Printf("âœ… å·²åŒæ­¥ä½™é¢: %.2f â†’ %.2f USDT (%s %.2f%%)", oldBalance, actualBalance, changeType, changePercent)
@@ -3642,13 +3650,6 @@ func (s *Server) handleGetGroupLeaders(c *gin.Context) {
 		role = "user" // é»˜è®¤æ˜¯æ™®é€šç”¨æˆ·
 	}
 
-	// è·å–æ‰€æœ‰å°ç»„ç»„é•¿
-	allUsers, err := s.database.GetAllUsers()
-	if err != nil {
-		c.JSON(http.StatusInternalServerError, gin.H{"error": "è·å–ç”¨æˆ·åˆ—è¡¨å¤±è´¥"})
-		return
-	}
-
 	var leaders []gin.H
 	for _, uid := range allUsers {
 		u, err := s.database.GetUserByID(uid)
@@ -3858,7 +3859,7 @@ func (s *Server) handleGetCategories(c *gin.Context) {
 
 	var categories []*config.Category
 	if user.Role == "admin" {
-		// Adminå¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ†ç±»ï¼ˆç‰¹æ®Šè§’è‰²ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ï¼‰
+		// ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ†ç±»ï¼ˆç‰¹æ®Šè§’è‰²ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ï¼‰
 		// è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œåªè¿”å›å½“å‰ç”¨æˆ·çš„åˆ†ç±»
 		categories, _ = s.database.GetCategoriesByOwner(userID)
 	} else {
@@ -4032,488 +4033,6 @@ func (s *Server) handleSetTraderCategory(c *gin.Context) {
 	// æ£€æŸ¥ç”¨æˆ·è§’è‰²ï¼ˆå¿…é¡»æ˜¯adminæˆ–userï¼‰
 	user, err := s.database.GetUserByID(userID)
 	if err != nil {
-		c.JSON(http.StatusUnauthorized, gin.H{"error": "ç”¨æˆ·ä¸å­˜åœ¨"})
-		return
-	}
-
-	if user.Role != "admin" && user.Role != "user" {
-		c.JSON(http.StatusForbidden, gin.H{"error": "æƒé™ä¸è¶³"})
-		return
-	}
-
-	var req struct {
-		Category string `json:"category"`
-	}
-
-	if err := c.ShouldBindJSON(&req); err != nil {
-		c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
-		return
-	}
-
-	// éªŒè¯äº¤æ˜“å‘˜æ˜¯å¦å­˜åœ¨
-	trader, err := s.database.GetTraderByID(traderID)
-	if err != nil || trader == nil {
-		c.JSON(http.StatusNotFound, gin.H{"error": "äº¤æ˜“å‘˜ä¸å­˜åœ¨"})
-		return
-	}
-
-	// å¦‚æœä¸æ˜¯adminï¼ŒéªŒè¯äº¤æ˜“å‘˜æ˜¯å¦å±äºå½“å‰ç”¨æˆ·
-	if user.Role != "admin" && trader.OwnerUserID != userID {
-		c.JSON(http.StatusForbidden, gin.H{"error": "åªèƒ½è®¾ç½®è‡ªå·±äº¤æ˜“å‘˜çš„åˆ†ç±»"})
-		return
-	}
-
-	// å¦‚æœæä¾›äº†åˆ†ç±»ï¼ŒéªŒè¯åˆ†ç±»æ˜¯å¦å±äºå½“å‰ç”¨æˆ·
-	if req.Category != "" {
-		if user.Role != "admin" {
-			category, err := s.database.GetCategoryByName(req.Category)
-			if err != nil || category == nil {
-				c.JSON(http.StatusNotFound, gin.H{"error": "åˆ†ç±»ä¸å­˜åœ¨"})
-				return
-			}
-			if category.OwnerUserID != userID {
-				c.JSON(http.StatusForbidden, gin.H{"error": "åªèƒ½ä½¿ç”¨è‡ªå·±çš„åˆ†ç±»"})
-				return
-			}
-		}
-	}
-
-	// æ›´æ–°äº¤æ˜“å‘˜åˆ†ç±»
-	err = s.database.UpdateTraderCategory(traderID, req.Category)
-	if err != nil {
-		c.JSON(http.StatusInternalServerError, gin.H{"error": "æ›´æ–°äº¤æ˜“å‘˜åˆ†ç±»å¤±è´¥: " + err.Error()})
-		return
-	}
-
-	// éªŒè¯æ›´æ–°æ˜¯å¦æˆåŠŸ
-	updatedTrader, err := s.database.GetTraderByID(traderID)
-	if err == nil && updatedTrader != nil {
-		log.Printf("[handleSetTraderCategory] Updated trader: ID=%s, Category=%s, OwnerUserID=%s",
-			updatedTrader.ID, updatedTrader.Category, updatedTrader.OwnerUserID)
-	}
-
-	c.JSON(http.StatusOK, gin.H{"message": "äº¤æ˜“å‘˜åˆ†ç±»å·²æ›´æ–°"})
-}
-
-// handleGetCategoryAccounts è·å–åˆ†ç±»è´¦å·åˆ—è¡¨
-// æ–°é€»è¾‘ï¼šå…ˆè·å–åˆ†ç±»ä¸‹çš„äº¤æ˜“å‘˜ï¼Œç„¶åé€šè¿‡ trader_account_id æ‰¾åˆ°å¯¹åº”çš„è´¦å·
-func (s *Server) handleGetCategoryAccounts(c *gin.Context) {
-	userID := c.GetString("user_id")
-
-	// è·å–ç”¨æˆ·è§’è‰²
-	user, err := s.database.GetUserByID(userID)
-	if err != nil {
-		c.JSON(http.StatusUnauthorized, gin.H{"error": "ç”¨æˆ·ä¸å­˜åœ¨"})
-		return
-	}
-
-	role := user.Role
-	if role == "" {
-		role = "user" // é»˜è®¤æ˜¯æ™®é€šç”¨æˆ·
-	}
-
-	var accounts []gin.H
-	var visibleCategories []string
-
-	// æ ¹æ®ç”¨æˆ·è§’è‰²ç¡®å®šå¯è§çš„åˆ†ç±»
-	if role == "admin" {
-		// ç®¡ç†å‘˜å¯ä»¥çœ‹åˆ°æ‰€æœ‰åˆ†ç±»
-		allCategories, _ := s.database.GetAllCategories()
-		for _, cat := range allCategories {
-			visibleCategories = append(visibleCategories, cat.Name)
-		}
-	} else if role == "group_leader" {
-		// å°ç»„ç»„é•¿å¯ä»¥çœ‹åˆ°è‡ªå·±ç®¡ç†çš„åˆ†ç±»
-		visibleCategories, _ = s.database.GetGroupLeaderCategories(userID)
-	} else if role == "user" {
-		// æ™®é€šç”¨æˆ·å¯ä»¥çœ‹åˆ°è‡ªå·±åˆ›å»ºçš„åˆ†ç±»
-		allCategories, _ := s.database.GetAllCategories()
-		for _, cat := range allCategories {
-			if cat != nil && cat.OwnerUserID == userID {
-				visibleCategories = append(visibleCategories, cat.Name)
-			}
-		}
-	}
-
-	// 1. å…ˆè·å–æ‰€æœ‰å¯è§åˆ†ç±»ä¸‹çš„äº¤æ˜“å‘˜ï¼ˆtradersï¼‰
-	traders, _ := s.database.GetTradersByCategories(visibleCategories)
-	log.Printf("ğŸ“Š æ‰¾åˆ° %d ä¸ªäº¤æ˜“å‘˜ï¼Œåˆ†ç±»: %v", len(traders), visibleCategories)
-
-	// 2. é€šè¿‡æ¯ä¸ª trader çš„ trader_account_id æ‰¾åˆ°å¯¹åº”çš„è´¦å·
-	traderAccountMap := make(map[string]*config.TraderRecord) // trader_account_id -> trader
-	for _, trader := range traders {
-		if trader.TraderAccountID != "" {
-			traderAccountMap[trader.TraderAccountID] = trader
-		}
-	}
-
-	// 3. è·å–è¿™äº›è´¦å·çš„ç”¨æˆ·ä¿¡æ¯
-	for accountID, trader := range traderAccountMap {
-		accountUser, err := s.database.GetUserByID(accountID)
-		if err != nil || accountUser == nil {
-			log.Printf("âš ï¸ æ‰¾ä¸åˆ°è´¦å·: account_id=%s, trader_id=%s", accountID, trader.ID)
-			continue
-		}
-
-		accounts = append(accounts, gin.H{
-			"id":         accountUser.ID,
-			"email":      accountUser.Email,
-			"role":       "trader_account", // æ˜ç¡®æ ‡è®°ä¸ºäº¤æ˜“å‘˜è´¦å·
-			"category":   trader.Category,
-			"trader_id":  trader.ID,
-			"created_at": accountUser.CreatedAt,
-		})
-		log.Printf("âœ… æ‰¾åˆ°äº¤æ˜“å‘˜è´¦å·: email=%s, trader_id=%s, category=%s", accountUser.Email, trader.ID, trader.Category)
-	}
-
-	// 4. è·å–å°ç»„ç»„é•¿è´¦å·ï¼ˆé€šè¿‡ group_leader_categories è¡¨ï¼‰
-	for _, categoryName := range visibleCategories {
-		// æŸ¥æ‰¾ç®¡ç†è¿™ä¸ªåˆ†ç±»çš„å°ç»„ç»„é•¿
-		allUsers, _ := s.database.GetAllUsers()
-		for _, uid := range allUsers {
-			u, err := s.database.GetUserByID(uid)
-			if err != nil || u.Role != "group_leader" {
-				continue
-			}
-
-			// æ£€æŸ¥è¿™ä¸ªå°ç»„ç»„é•¿æ˜¯å¦ç®¡ç†å½“å‰åˆ†ç±»
-			categories, _ := s.database.GetGroupLeaderCategories(uid)
-			for _, cat := range categories {
-				if cat == categoryName {
-					// æ£€æŸ¥æƒé™
-					if role != "admin" {
-						if role == "user" {
-							// æ™®é€šç”¨æˆ·åªèƒ½çœ‹åˆ°è‡ªå·±åˆ›å»ºçš„åˆ†ç±»ä¸‹çš„å°ç»„ç»„é•¿
-							categoryObj, _ := s.database.GetCategoryByName(categoryName)
-							if categoryObj == nil || categoryObj.OwnerUserID != userID {
-								continue
-							}
-						}
-						// group_leader å¯ä»¥çœ‹åˆ°ç®¡ç†ç›¸åŒåˆ†ç±»çš„å…¶ä»–å°ç»„ç»„é•¿
-					}
-
-					accounts = append(accounts, gin.H{
-						"id":         u.ID,
-						"email":      u.Email,
-						"role":       "group_leader",
-						"category":   categoryName,
-						"trader_id":  nil,
-						"created_at": u.CreatedAt,
-					})
-					log.Printf("âœ… æ‰¾åˆ°å°ç»„ç»„é•¿è´¦å·: email=%s, category=%s", u.Email, categoryName)
-					break
-				}
-			}
-		}
-	}
-
-	log.Printf("ğŸ“Š è¿”å›è´¦å·åˆ—è¡¨ï¼Œå…± %d ä¸ªè´¦å·", len(accounts))
-	c.JSON(http.StatusOK, accounts)
-}
-
-// handleGetCategoryAccountInfo è·å–åˆ†ç±»è´¦å·ä¿¡æ¯
-func (s *Server) handleGetCategoryAccountInfo(c *gin.Context) {
-	userID := c.GetString("user_id")
-	accountID := c.Param("id")
-
-	// è·å–ç”¨æˆ·è§’è‰²
-	user, err := s.database.GetUserByID(userID)
-	if err != nil {
-		c.JSON(http.StatusUnauthorized, gin.H{"error": "ç”¨æˆ·ä¸å­˜åœ¨"})
-		return
-	}
-
-	role := user.Role
-	if role == "" {
-		role = "user"
-	}
-
-	// è·å–è´¦å·ä¿¡æ¯
-	account, err := s.database.GetUserByID(accountID)
-	if err != nil || account == nil {
-		c.JSON(http.StatusNotFound, gin.H{"error": "è´¦å·ä¸å­˜åœ¨"})
-		return
-	}
-
-	if account.Role != "group_leader" && account.Role != "trader_account" {
-		c.JSON(http.StatusNotFound, gin.H{"error": "è´¦å·ä¸å­˜åœ¨"})
-		return
-	}
-
-	// æƒé™æ£€æŸ¥ï¼šå¦‚æœä¸æ˜¯adminï¼ŒéªŒè¯è´¦å·æ˜¯å¦å±äºå½“å‰ç”¨æˆ·
-	if role != "admin" {
-		hasPermission := false
-		if account.Role == "group_leader" {
-			categories, _ := s.database.GetGroupLeaderCategories(accountID)
-			for _, cat := range categories {
-				category, _ := s.database.GetCategoryByName(cat)
-				if category != nil && category.OwnerUserID == userID {
-					hasPermission = true
-					break
-				}
-			}
-		} else if account.Role == "trader_account" {
-			trader, _ := s.database.GetTraderByID(account.Email)
-			if trader != nil && trader.OwnerUserID == userID {
-				hasPermission = true
-			}
-		}
-		if !hasPermission {
-			c.JSON(http.StatusForbidden, gin.H{"error": "æ— æƒæŸ¥çœ‹æ­¤è´¦å·"})
-			return
-		}
-	}
-
-	// è·å–å¯†ç ï¼ˆå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è·å–ï¼Œéœ€è¦è§£å¯†å­˜å‚¨çš„å¯†ç ï¼‰
-	password := ""
-	if account.PasswordHash != "" {
-		// å¯†ç æ˜¯æ˜æ–‡å­˜å‚¨çš„ï¼ˆä¸å®‰å…¨ï¼Œä½†åœ¨ç”¨æˆ·è¦æ±‚ä¸‹è¿™æ ·åšï¼‰
-		password = account.PasswordHash
-	}
-
-	c.JSON(http.StatusOK, gin.H{
-		"id":       account.ID,
-		"email":    account.Email,
-		"role":     account.Role,
-		"password": password,
-	})
-}
-
-// handleUpdateCategoryAccountPassword æ›´æ–°åˆ†ç±»è´¦å·å¯†ç 
-func (s *Server) handleUpdateCategoryAccountPassword(c *gin.Context) {
-	userID := c.GetString("user_id")
-	accountID := c.Param("id")
-
-	// è·å–ç”¨æˆ·è§’è‰²
-	user, err := s.database.GetUserByID(userID)
-	if err != nil {
-		c.JSON(http.StatusUnauthorized, gin.H{"error": "ç”¨æˆ·ä¸å­˜åœ¨"})
-		return
-	}
-
-	role := user.Role
-	if role == "" {
-		role = "user"
-	}
-
-	// è·å–è´¦å·ä¿¡æ¯
-	account, err := s.database.GetUserByID(accountID)
-	if err != nil || account == nil {
-		c.JSON(http.StatusNotFound, gin.H{"error": "è´¦å·ä¸å­˜åœ¨"})
-		return
-	}
-
-	if account.Role != "group_leader" && account.Role != "trader_account" {
-		c.JSON(http.StatusBadRequest, gin.H{"error": "æ— æ•ˆçš„è´¦å·ç±»å‹"})
-		return
-	}
-
-	// æƒé™æ£€æŸ¥ï¼šå¦‚æœä¸æ˜¯adminï¼ŒéªŒè¯è´¦å·æ˜¯å¦å±äºå½“å‰ç”¨æˆ·
-	if role != "admin" {
-		hasPermission := false
-		if account.Role == "group_leader" {
-			categories, _ := s.database.GetGroupLeaderCategories(accountID)
-			for _, cat := range categories {
-				category, _ := s.database.GetCategoryByName(cat)
-				if category != nil && category.OwnerUserID == userID {
-					hasPermission = true
-					break
-				}
-			}
-		} else if account.Role == "trader_account" {
-			trader, _ := s.database.GetTraderByID(account.Email)
-			if trader != nil && trader.OwnerUserID == userID {
-				hasPermission = true
-			}
-		}
-		if !hasPermission {
-			c.JSON(http.StatusForbidden, gin.H{"error": "æ— æƒä¿®æ”¹æ­¤è´¦å·"})
-			return
-		}
-	}
-
-	var req struct {
-		Password string `json:"password" binding:"required"`
-	}
-
-	if err := c.ShouldBindJSON(&req); err != nil {
-		c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
-		return
-	}
-
-	// å“ˆå¸Œæ–°å¯†ç 
-	hashedPassword, err := auth.HashPassword(req.Password)
-	if err != nil {
-		c.JSON(http.StatusInternalServerError, gin.H{"error": "å¯†ç å¤„ç†å¤±è´¥"})
-		return
-	}
-
-	// æ›´æ–°å¯†ç 
-	err = s.database.UpdateUserPassword(accountID, hashedPassword)
-	if err != nil {
-		c.JSON(http.StatusInternalServerError, gin.H{"error": "æ›´æ–°å¯†ç å¤±è´¥: " + err.Error()})
-		return
-	}
-
-	c.JSON(http.StatusOK, gin.H{"message": "å¯†ç å·²æ›´æ–°"})
-}
-
-// handleGetActiveStrategy è·å–å½“å‰å…¨å±€æ´»è·ƒç­–ç•¥
-func (s *Server) handleGetActiveStrategy(c *gin.Context) {
-	if signal.GlobalManager == nil {
-		c.JSON(http.StatusOK, gin.H{"strategy": nil})
-		return
-	}
-
-	strat, t := signal.GlobalManager.GetActiveStrategy()
-	if strat == nil {
-		c.JSON(http.StatusOK, gin.H{"strategy": nil})
-		return
-	}
-
-	// è·å–æœ€æ–°ä»·æ ¼ï¼Œç”¨äºè®¡ç®—è¿›åº¦
-	currentPrice := 0.0
-	marketData, err := market.Get(strat.Symbol)
-	if err == nil {
-		currentPrice = marketData.CurrentPrice
-	}
-
-	c.JSON(http.StatusOK, gin.H{
-		"strategy":      strat,
-		"updated_at":    t,
-		"current_price": currentPrice,
-	})
-}
-
-// handleGetTraderStrategyStatus è·å–äº¤æ˜“å‘˜çš„ç­–ç•¥æ‰§è¡ŒçŠ¶æ€
-func (s *Server) handleGetTraderStrategyStatus(c *gin.Context) {
-	id := c.Param("id")
-	status, err := s.database.GetTraderStrategyStatus(id)
-	if err != nil {
-		// å¦‚æœæ²¡æœ‰è®°å½•ï¼Œè¿”å›ç©ºå¯¹è±¡è€Œä¸æ˜¯404ï¼Œæ–¹ä¾¿å‰ç«¯å¤„ç†
-		c.JSON(http.StatusOK, gin.H{})
-		return
-	}
-	c.JSON(http.StatusOK, status)
-}
-
-// handleGetStrategyDecisions è·å–äº¤æ˜“å‘˜çš„ç­–ç•¥å†³ç­–å†å²
-func (s *Server) handleGetStrategyDecisions(c *gin.Context) {
-	id := c.Param("id")
-	userID := c.GetString("user_id")
-	if id == "" {
-		c.JSON(http.StatusBadRequest, gin.H{"error": "trader_id is required"})
-		return
-	}
-
-	// éªŒè¯äº¤æ˜“å‘˜æ˜¯å¦å±äºå½“å‰ç”¨æˆ·ï¼ˆå…¼å®¹å¤šè§’è‰²ï¼šåˆ›å»ºè€…ã€æœ¬ä½“è´¦å·ã€å…³è”çš„äº¤æ˜“å‘˜è´¦å·ã€ç®¡ç†å‘˜ï¼‰
-	trader, err := s.database.GetTraderByID(id)
-	if err != nil || trader == nil {
-		c.JSON(http.StatusInternalServerError, gin.H{"error": "è·å–äº¤æ˜“å‘˜ä¿¡æ¯å¤±è´¥"})
-		return
-	}
-
-	// è·å–ç”¨æˆ·è§’è‰²
-	user, err := s.database.GetUserByID(userID)
-	if err != nil {
-		c.JSON(http.StatusUnauthorized, gin.H{"error": "ç”¨æˆ·ä¸å­˜åœ¨"})
-		return
-	}
-
-	role := user.Role
-	if role == "" {
-		role = "user"
-	}
-
-	// admin å¯ä»¥æŸ¥çœ‹æ‰€æœ‰äº¤æ˜“å‘˜
-	if role != "admin" {
-		ownerID := trader.OwnerUserID
-		if ownerID == "" {
-			ownerID = trader.UserID
-		}
-
-		// å…è®¸ï¼šåˆ›å»ºè€…ã€æœ¬ä½“ user_idã€ç»‘å®šçš„ trader_account ç”¨æˆ·
-		if userID != ownerID && userID != trader.UserID && userID != trader.TraderAccountID {
-		c.JSON(http.StatusForbidden, gin.H{"error": "æ— æƒè®¿é—®è¯¥äº¤æ˜“å‘˜"})
-		return
-		}
-	}
-
-	// æ”¯æŒå››ç§æ¨¡å¼ï¼šlatestï¼ˆæœ€æ–°Næ¡ï¼‰ã€openï¼ˆæ‰€æœ‰å¼€ä»“ï¼‰ã€closeï¼ˆæ‰€æœ‰å¹³ä»“ï¼‰ã€sltpï¼ˆæ­¢ç›ˆæ­¢æŸï¼‰
-	mode := c.Query("mode") // latest | open | close | sltp
-	if mode == "" {
-		mode = "latest" // é»˜è®¤ä¸ºæœ€æ–°æ¨¡å¼
-	}
-
-	var decisions []*config.StrategyDecisionHistory
-
-	switch mode {
-	case "open":
-		// æ‰€æœ‰å¼€ä»“/åŠ ä»“å†³ç­–ï¼ˆSQLçº§åˆ«è¿‡æ»¤ï¼Œä¸é™åˆ¶æ•°é‡ï¼‰
-		var openErr error
-		decisions, openErr = s.database.GetAllOpenStrategyDecisions(id)
-		if openErr != nil {
-			c.JSON(http.StatusInternalServerError, gin.H{"error": fmt.Sprintf("è·å–å¼€ä»“å†³ç­–å¤±è´¥: %v", openErr)})
-			return
-		}
-		log.Printf("âœ“ [å†³ç­–æŸ¥è¯¢] trader=%s mode=open è¿”å› %d æ¡", id, len(decisions))
-		
-	case "close":
-		// æ‰€æœ‰å¹³ä»“å†³ç­–ï¼ˆSQLçº§åˆ«è¿‡æ»¤ï¼Œä¸é™åˆ¶æ•°é‡ï¼‰
-		var closeErr error
-		decisions, closeErr = s.database.GetAllCloseStrategyDecisions(id)
-		if closeErr != nil {
-			c.JSON(http.StatusInternalServerError, gin.H{"error": fmt.Sprintf("è·å–å¹³ä»“å†³ç­–å¤±è´¥: %v", closeErr)})
-			return
-		}
-		log.Printf("âœ“ [å†³ç­–æŸ¥è¯¢] trader=%s mode=close è¿”å› %d æ¡", id, len(decisions))
-
-	case "sltp":
-		// æ‰€æœ‰æ­¢ç›ˆæ­¢æŸç›¸å…³å†³ç­–ï¼ˆåŒ…å« STOP, TP, SL, PROFIT, LOSS å…³é”®å­—ï¼‰
-		var sltpErr error
-		decisions, sltpErr = s.database.GetAllSLTPStrategyDecisions(id)
-		if sltpErr != nil {
-			c.JSON(http.StatusInternalServerError, gin.H{"error": fmt.Sprintf("è·å–æ­¢ç›ˆæ­¢æŸå†³ç­–å¤±è´¥: %v", sltpErr)})
-			return
-		}
-		log.Printf("âœ“ [å†³ç­–æŸ¥è¯¢] trader=%s mode=sltp è¿”å› %d æ¡", id, len(decisions))
-
-	case "order":
-		// æ‰€æœ‰å§”æ‰˜å•æ“ä½œç›¸å…³å†³ç­–ï¼ˆset_tp_order, set_sl_order, cancel ç­‰ï¼‰
-		var orderErr error
-		decisions, orderErr = s.database.GetAllOrderStrategyDecisions(id)
-		if orderErr != nil {
-			c.JSON(http.StatusInternalServerError, gin.H{"error": fmt.Sprintf("è·å–å§”æ‰˜å•å†³ç­–å¤±è´¥: %v", orderErr)})
-			return
-		}
-		log.Printf("âœ“ [å†³ç­–æŸ¥è¯¢] trader=%s mode=order è¿”å› %d æ¡", id, len(decisions))
-		
-	default: // "latest"
-		// æœ€æ–°Næ¡ï¼ˆé»˜è®¤50æ¡ï¼‰
-		limit := 50
-		if limitStr := c.Query("limit"); limitStr != "" {
-			if parsedLimit, parseErr := strconv.Atoi(limitStr); parseErr == nil && parsedLimit > 0 {
-				limit = parsedLimit
-			}
-		}
-		var latestErr error
-		decisions, latestErr = s.database.GetStrategyDecisionHistory(id, limit)
-		if latestErr != nil {
-			c.JSON(http.StatusInternalServerError, gin.H{"error": fmt.Sprintf("è·å–å†³ç­–å†å²å¤±è´¥: %v", latestErr)})
-			return
-		}
-		log.Printf("âœ“ [å†³ç­–æŸ¥è¯¢] trader=%s mode=latest limit=%d è¿”å› %d æ¡", id, limit, len(decisions))
-	}
-
-
-	// å¦‚æœæ²¡æœ‰è®°å½•ï¼Œè¿”å›ç©ºæ•°ç»„
-	if decisions == nil {
-		decisions = []*config.StrategyDecisionHistory{}
-	}
-
-	c.JSON(http.StatusOK, gin.H{
-		"decisions": decisions,
-		"total":     len(decisions),
-		"mode":      mode,
+		"content":      report.MarkdownContent,
 	})
 }
