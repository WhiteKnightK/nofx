# ğŸ”§ Docker ä»£ç†é…ç½®æ–¹æ¡ˆ

ç”±äº2024-2025å¹´å›½å†…Docker Hubå…¬å…±é•œåƒåŠ é€Ÿå™¨å¤§è§„æ¨¡åœæ­¢æœåŠ¡ï¼Œç°åœ¨æœ‰ä»¥ä¸‹å‡ ä¸ªå®ç”¨æ–¹æ¡ˆï¼š

---

## æ–¹æ¡ˆ1ï¼šæ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒï¼ˆæœ€ç®€å•ï¼Œæ¨èå…ˆè¯•ï¼‰

å¦‚æœæ‚¨çš„ç½‘ç»œå¶å°”èƒ½è®¿é—®Docker Hubï¼Œå¯ä»¥å…ˆæ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒï¼š

```bash
./æ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒ.sh
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- æ‹‰å– `alpine:latest`
- æ‹‰å– `golang:1.25-alpine`
- é•œåƒä¼šç¼“å­˜åœ¨æœ¬åœ°
- æ„å»ºæ—¶ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œä¸éœ€è¦å†ä¸‹è½½

**ä¼˜ç‚¹**ï¼š
- âœ… æœ€ç®€å•ï¼Œæ— éœ€é…ç½®
- âœ… ä¸€æ¬¡æ‹‰å–ï¼Œæ°¸ä¹…ä½¿ç”¨
- âœ… ä¸éœ€è¦ä»£ç†å¸¸é©»

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦è‡³å°‘ä¸€æ¬¡èƒ½è®¿é—®Docker Hub

---

## æ–¹æ¡ˆ2ï¼šé…ç½®Dockerä½¿ç”¨ç³»ç»Ÿä»£ç†

å¦‚æœæ‚¨æœ‰Clashã€V2Rayç­‰ä»£ç†å·¥å…·ï¼ˆé€šå¸¸è¿è¡Œåœ¨Windowsä¸Šï¼‰ï¼š

### 2.1 æ£€æŸ¥ä»£ç†ç«¯å£

åœ¨Windowsä¸ŠæŸ¥çœ‹æ‚¨çš„ä»£ç†å·¥å…·ï¼ˆå¦‚Clashï¼‰ï¼Œé€šå¸¸æ˜¯ï¼š
- HTTPä»£ç†ï¼š`127.0.0.1:7890` æˆ– `7891`
- SOCKS5ä»£ç†ï¼š`127.0.0.1:7890` æˆ– `7891`

åœ¨WSL2ä¸­ï¼ŒWindowsä¸»æœºçš„IPä¸æ˜¯`127.0.0.1`ï¼Œéœ€è¦è·å–ï¼š

```bash
# è·å–Windowsä¸»æœºIP
export WINDOWS_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')
echo "Windows IP: $WINDOWS_IP"
```

### 2.2 é…ç½®Dockerä»£ç†ï¼ˆä¸´æ—¶ï¼‰

```bash
# æ–¹å¼1ï¼šä¸ºå•æ¬¡æ„å»ºè®¾ç½®ä»£ç†
export HTTP_PROXY="http://$WINDOWS_IP:7890"
export HTTPS_PROXY="http://$WINDOWS_IP:7890"
export NO_PROXY="localhost,127.0.0.1"

# ç„¶åè¿è¡Œæ„å»º
./ä¸€é”®æ¨é€.sh
```

### 2.3 é…ç½®Dockerä»£ç†ï¼ˆæ°¸ä¹…ï¼‰

åˆ›å»ºDocker daemonçš„ä»£ç†é…ç½®ï¼š

```bash
# åˆ›å»ºsystemdé…ç½®ç›®å½•
sudo mkdir -p /etc/systemd/system/docker.service.d

# è·å–Windows IP
WINDOWS_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')

# åˆ›å»ºä»£ç†é…ç½®æ–‡ä»¶
sudo tee /etc/systemd/system/docker.service.d/http-proxy.conf > /dev/null <<EOF
[Service]
Environment="HTTP_PROXY=http://$WINDOWS_IP:7890"
Environment="HTTPS_PROXY=http://$WINDOWS_IP:7890"
Environment="NO_PROXY=localhost,127.0.0.1"
EOF

# é‡å¯Docker
sudo systemctl daemon-reload
sudo systemctl restart docker

# éªŒè¯
docker info | grep -i proxy
```

**æ³¨æ„**ï¼š
- æ›¿æ¢ `7890` ä¸ºæ‚¨å®é™…çš„ä»£ç†ç«¯å£
- ç¡®ä¿Windowsé˜²ç«å¢™å…è®¸WSLè®¿é—®ä»£ç†ç«¯å£
- ç¡®ä¿Clash/V2Rayå¼€å¯äº†"å…è®¸å±€åŸŸç½‘è¿æ¥"

---

## æ–¹æ¡ˆ3ï¼šä½¿ç”¨è‡ªåŠ¨ä»£ç†è„šæœ¬

æˆ‘å·²ç»ä¸ºæ‚¨åˆ›å»ºäº†ä¸€ä¸ªè‡ªåŠ¨é…ç½®è„šæœ¬ï¼š

```bash
./é…ç½®Dockerä»£ç†.sh
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
1. è‡ªåŠ¨æ£€æµ‹Windowsä¸»æœºIP
2. æµ‹è¯•å¸¸ç”¨ä»£ç†ç«¯å£ï¼ˆ7890, 7891, 10809ç­‰ï¼‰
3. è‡ªåŠ¨é…ç½®Docker daemon
4. é‡å¯DockeræœåŠ¡

---

## æ–¹æ¡ˆ4ï¼šä»æœåŠ¡å™¨æ‹‰å–é•œåƒï¼ˆå¦‚æœæ‚¨æœ‰å›½å¤–æœåŠ¡å™¨ï¼‰

å¦‚æœæ‚¨æœ‰å›½å¤–æœåŠ¡å™¨è®¿é—®Docker Hubï¼š

### 4.1 åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–å¹¶ä¿å­˜é•œåƒ

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
docker pull alpine:latest
docker pull golang:1.25-alpine
docker save alpine:latest golang:1.25-alpine | gzip > base-images.tar.gz

# ä¸‹è½½åˆ°æœ¬åœ°
scp -i A.pem ubuntu@43.202.115.56:~/base-images.tar.gz .
```

### 4.2 åœ¨æœ¬åœ°å¯¼å…¥é•œåƒ

```bash
# å¯¼å…¥é•œåƒ
docker load < base-images.tar.gz

# éªŒè¯
docker images | grep -E "alpine|golang"
```

---

## æ–¹æ¡ˆ5ï¼šä½¿ç”¨Docker Desktopçš„é•œåƒåŠ é€Ÿï¼ˆä»…Windows/Macï¼‰

å¦‚æœæ‚¨ä½¿ç”¨Docker Desktopï¼š

1. æ‰“å¼€ Docker Desktop
2. Settings â†’ Docker Engine
3. æš‚æ—¶ç§»é™¤æ‰€æœ‰å¤±æ•ˆçš„é•œåƒåŠ é€Ÿå™¨é…ç½®
4. æˆ–é…ç½®è‡ªå·±çš„ç§æœ‰é•œåƒä»“åº“

---

## ğŸ¯ æ¨èæµç¨‹

### ç¬¬ä¸€æ­¥ï¼šå°è¯•æ–¹æ¡ˆ1ï¼ˆæœ€ç®€å•ï¼‰

```bash
./æ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒ.sh
```

å¦‚æœæˆåŠŸï¼Œç›´æ¥è¿è¡Œï¼š
```bash
./ä¸€é”®æ¨é€.sh
```

### ç¬¬äºŒæ­¥ï¼šå¦‚æœæ–¹æ¡ˆ1å¤±è´¥ï¼Œä½¿ç”¨æ–¹æ¡ˆ2

```bash
# å¿«é€Ÿæµ‹è¯•ä»£ç†æ˜¯å¦å¯ç”¨
WINDOWS_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')
curl --proxy http://$WINDOWS_IP:7890 https://www.google.com
```

å¦‚æœä»£ç†å¯ç”¨ï¼Œè¿è¡Œï¼š
```bash
./é…ç½®Dockerä»£ç†.sh
```

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®å®Œæˆå

```bash
./ä¸€é”®æ¨é€.sh
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆé•œåƒåŠ é€Ÿå™¨éƒ½å¤±æ•ˆäº†ï¼Ÿ

**A**: 2024å¹´èµ·ï¼Œå›½å†…Docker Hubå…¬å…±é•œåƒæœåŠ¡å¤§è§„æ¨¡å…³é—­ï¼š
- é˜¿é‡Œäº‘é•œåƒæœåŠ¡ï¼šä»…é™ä¼ä¸šç”¨æˆ·
- ç½‘æ˜“é•œåƒï¼šå·²å…³é—­
- ä¸­ç§‘å¤§é•œåƒï¼šå·²å…³é—­
- DaoCloudé•œåƒï¼šéƒ¨åˆ†å…³é—­

### Q2: æ‰‹åŠ¨æ‹‰å–é•œåƒä¼šå¾ˆæ…¢å—ï¼Ÿ

**A**: å–å†³äºæ‚¨çš„ç½‘ç»œç¯å¢ƒï¼š
- ç›´è¿Docker Hubï¼š1-5åˆ†é’Ÿ
- é«˜å³°æœŸå¯èƒ½éœ€è¦ï¼š10-30åˆ†é’Ÿ
- ä½¿ç”¨ä»£ç†ï¼šé€šå¸¸1-2åˆ†é’Ÿ

ä½†**åªéœ€è¦æ‹‰å–ä¸€æ¬¡**ï¼Œä¹‹åéƒ½ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚

### Q3: ä»£ç†é…ç½®åä¼šå½±å“å…¶ä»–ç½‘ç»œå—ï¼Ÿ

**A**: ä¸ä¼šã€‚Docker daemonçš„ä»£ç†é…ç½®ï¼š
- åªå½±å“Dockeræ‹‰å–é•œåƒ
- ä¸å½±å“å®¹å™¨å†…ç½‘ç»œ
- ä¸å½±å“ä¸»æœºå…¶ä»–åº”ç”¨

### Q4: WSL2è®¿é—®Windowsä»£ç†å¤±è´¥

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. **Windowsé˜²ç«å¢™**ï¼š
   - å…è®¸WSLè®¿é—®ä»£ç†ç«¯å£
   - æˆ–ä¸´æ—¶å…³é—­é˜²ç«å¢™æµ‹è¯•

2. **ä»£ç†å·¥å…·é…ç½®**ï¼š
   - Clash: å¼€å¯"å…è®¸å±€åŸŸç½‘è¿æ¥"
   - V2Ray: å…è®¸æ¥è‡ªå±€åŸŸç½‘çš„è¿æ¥

3. **æµ‹è¯•è¿æ¥**ï¼š
```bash
WINDOWS_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')
nc -zv $WINDOWS_IP 7890
```

### Q5: æˆ‘åº”è¯¥ç”¨å“ªä¸ªæ–¹æ¡ˆï¼Ÿ

**æ¨èé¡ºåº**ï¼š
1. å…ˆè¯•**æ–¹æ¡ˆ1**ï¼ˆæ‰‹åŠ¨æ‹‰å–ï¼‰ï¼Œæœ€ç®€å•
2. å¦‚æœå¤±è´¥ï¼Œç”¨**æ–¹æ¡ˆ2**ï¼ˆé…ç½®ä»£ç†ï¼‰
3. å¦‚æœæ²¡æœ‰ä»£ç†ï¼Œç”¨**æ–¹æ¡ˆ4**ï¼ˆä»æœåŠ¡å™¨æ‹‰å–ï¼‰

---

## ğŸ’¡ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

```bash
# æ–¹æ¡ˆ1: æ‰‹åŠ¨æ‹‰å–
./æ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒ.sh

# æ–¹æ¡ˆ2: é…ç½®ä»£ç†ï¼ˆè‡ªåŠ¨ï¼‰
./é…ç½®Dockerä»£ç†.sh

# æ–¹æ¡ˆ2: é…ç½®ä»£ç†ï¼ˆæ‰‹åŠ¨ï¼‰
export WINDOWS_IP=$(cat /etc/resolv.conf | grep nameserver | awk '{print $2}')
export HTTP_PROXY="http://$WINDOWS_IP:7890"
export HTTPS_PROXY="http://$WINDOWS_IP:7890"
./ä¸€é”®æ¨é€.sh

# æŸ¥çœ‹æœ¬åœ°å·²æœ‰é•œåƒ
docker images

# æµ‹è¯•Dockeræ˜¯å¦èƒ½è®¿é—®å¤–ç½‘
docker run --rm alpine ping -c 3 google.com
```

---

## ğŸ‰ æ€»ç»“

- âœ… **æ–¹æ¡ˆ1æœ€ç®€å•**ï¼šå…ˆæ‰‹åŠ¨æ‹‰å–åŸºç¡€é•œåƒ
- âœ… **æ–¹æ¡ˆ2æœ€ç¨³å®š**ï¼šé…ç½®ç³»ç»Ÿä»£ç†ï¼ˆå¦‚æœæœ‰ï¼‰
- âœ… é•œåƒåªéœ€æ‹‰å–ä¸€æ¬¡ï¼Œä¹‹åæ°¸ä¹…ä½¿ç”¨æœ¬åœ°ç¼“å­˜
- âœ… é…ç½®å®Œæˆåï¼Œæ¨é€è¿‡ç¨‹ä¸éœ€è¦ä»£ç†

ç°åœ¨å°±è¯•è¯•æ–¹æ¡ˆ1å§ï¼ğŸš€



